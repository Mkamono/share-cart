version: "3"

tasks:
  generate:
    cmd: ogen --package oas --target app/oas --clean docs/openapi.yaml
    sources:
      - docs/openapi.yaml

  air:
    cmd: air -c .air.toml

  dev:
    cmds:
      - task: generate
      - task: graph
      - task: air

  graph:
    cmd: godepgraph -o .,api -s . | dot -Tpng -o ./docs/dependancy.png
    sources:
      - ./**/*.go
